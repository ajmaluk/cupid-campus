import{c as P,u as $,a as q,r as d,j as e,m as n,A as S,s as h}from"./index-D7HYzwzr.js";import{B as O}from"./Button-DPgdzv4R.js";import{I as f,C as F}from"./Input-D0frGL1v.js";import{D as U,M as Y,Y as B,I as V}from"./index-C2QYkVRQ.js";import{L as W,w as J}from"./welcome-D7Kvz1QO.js";import{C as G}from"./chevron-left-CwTAo27J.js";import{C as v}from"./chevron-right-CNg-Er96.js";import{L as E}from"./lock-6zx9YT-I.js";import{P as H}from"./pen-DUbqsFwP.js";import{L as K}from"./loader-circle-ChAVFfyN.js";const Q=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],X=P("calendar",Q);const Z=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],I=P("play",Z),y=["Personal Details","Account","Verification","Interests","Welcome"];function de(){const j=$(),{setCurrentUser:D}=q(),[i,u]=d.useState(0),[N,m]=d.useState(!1),[k,c]=d.useState(""),[b,_]=d.useState(""),[a,C]=d.useState({name:"",dob:"",gender:"",interested_in:"",department:"",major:"",year:"",username:"",email:"",password:"",confirmPassword:"",interests:[],photos:[],bio:""}),[p,w]=d.useState(0);d.useEffect(()=>{let t;return p>0&&(t=setInterval(()=>{w(r=>r-1)},1e3)),()=>clearInterval(t)},[p]);const l=(t,r)=>{C(t==="department"?s=>({...s,[t]:r,major:""}):s=>({...s,[t]:r})),c("")},z=t=>{switch(t){case 0:return a.name?a.dob?a.gender?a.interested_in?a.department?a.major?a.year?null:"Year is required":"Major is required":"Department is required":"Please select who you're interested in":"Please select your gender":"Date of Birth is required":"Name is required";case 1:return a.username?a.email?a.email.endsWith("@cet.ac.in")?a.password?a.password.length<6?"Password must be at least 6 characters":a.password!==a.confirmPassword?"Passwords do not match":null:"Password is required":"Must be a @cet.ac.in email":"Email is required":"Username is required";case 3:return a.interests.length<3?"Select at least 3 interests":null;default:return null}},M=async()=>{const t=z(i);if(t){c(t);return}if(i===1){m(!0);try{const{data:r,error:s}=await h.from("profiles").select("username").eq("username",a.username).maybeSingle();if(s)throw s;if(r)throw new Error("Username already taken");const{error:o}=await h.auth.signUp({email:a.email,password:a.password,options:{data:{full_name:a.name,username:a.username}}});if(o)throw o;w(60),u(x=>x+1)}catch(r){console.error("Signup Error:",r);const s=r?.message||r?.error_description||JSON.stringify(r);c(s)}finally{m(!1)}}else if(i===2){if(!b||b.length!==6){c("Please enter a valid 6-digit OTP");return}m(!0);try{const{data:r,error:s}=await h.auth.verifyOtp({email:a.email,token:b,type:"signup"});if(s)throw s;const o=r.user?.id;if(o){const x={id:o,name:a.name,username:a.username,dob:a.dob,age:L(a.dob),gender:a.gender,interested_in:a.interested_in,department:a.department,major:a.major,course:`${a.department} - ${a.major}`,year:a.year,bio:"",interests:a.interests,photos:[],primary_photo:`https://ui-avatars.com/api/?name=${a.name}&background=random`,created_at:new Date().toISOString()},{error:g}=await h.from("profiles").upsert(x);if(g)throw g;D(x),u(R=>R+1)}}catch(r){console.error("Verification Error:",r);const s=r?.message||"Verification failed";c(s)}finally{m(!1)}}else u(r=>r+1)},T=()=>{c(""),i>0?u(t=>t-1):j("/")},A=async()=>{if(!(p>0)){m(!0);try{const{error:t}=await h.auth.resend({type:"signup",email:a.email});if(t)throw t;w(60)}catch(t){console.error("Resend Error:",t),c(t.message||"Failed to resend code")}finally{m(!1)}}},L=t=>{const r=new Date(t),s=Date.now()-r.getTime(),o=new Date(s);return Math.abs(o.getUTCFullYear()-1970)};return e.jsxs("div",{className:"min-h-screen w-full flex bg-background overflow-hidden",children:[e.jsxs("div",{className:"hidden md:flex w-1/2 relative bg-black/40 items-center justify-center overflow-hidden border-r border-white/5",children:[e.jsx(n.div,{animate:{scale:[1,1.2,1],rotate:[0,45,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-[-20%] left-[-20%] w-[800px] h-[800px] bg-primary/20 rounded-full blur-[120px] opacity-40"}),e.jsx(n.div,{animate:{scale:[1,1.3,1],rotate:[0,-45,0]},transition:{duration:25,repeat:1/0,ease:"linear"},className:"absolute bottom-[-20%] right-[-20%] w-[800px] h-[800px] bg-purple-500/20 rounded-full blur-[120px] opacity-40"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center p-12 max-w-xl",children:[e.jsx(n.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.8},className:"mb-8",children:e.jsx("div",{className:"w-32 h-32 bg-gradient-to-tr from-primary to-purple-600 rounded-[40px] flex items-center justify-center shadow-2xl shadow-primary/30 mx-auto transform rotate-12",children:e.jsx(I,{className:"text-white w-16 h-16 fill-current"})})}),e.jsx(n.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.8},className:"text-6xl font-bold text-white mb-6 tracking-tight",children:"Join the Club"}),e.jsxs(n.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.8},className:"text-xl text-gray-300 leading-relaxed",children:["Create your profile, find your vibe, ",e.jsx("br",{}),"and connect with your campus."]})]})]}),e.jsxs("div",{className:"w-full md:w-1/2 relative flex flex-col items-center justify-center p-0 md:p-6 bg-background h-screen md:h-auto",children:[e.jsxs("div",{className:"md:hidden absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx(n.div,{animate:{scale:[1,1.2,1],rotate:[0,90,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-[-20%] left-[-20%] w-[600px] h-[600px] bg-primary/20 rounded-full blur-[120px] opacity-60"}),e.jsx(n.div,{animate:{scale:[1,1.3,1],rotate:[0,-90,0]},transition:{duration:25,repeat:1/0,ease:"linear"},className:"absolute bottom-[-20%] right-[-20%] w-[600px] h-[600px] bg-purple-500/20 rounded-full blur-[120px] opacity-60"})]}),e.jsx("div",{className:"hidden md:block absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-primary/5 rounded-full blur-[100px]"})}),e.jsxs(n.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.8,ease:"easeOut"},className:"z-10 w-full md:max-w-md h-full md:h-auto bg-black/40 md:bg-white/5 backdrop-blur-3xl md:backdrop-blur-2xl border-none md:border md:border-white/10 md:rounded-[40px] p-6 md:p-8 md:shadow-2xl relative overflow-hidden flex flex-col",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-white/50 to-transparent opacity-50"}),e.jsxs("div",{className:"flex items-center gap-4 mb-8 mt-4 md:mt-0 z-10 shrink-0",children:[e.jsx("button",{onClick:T,className:"p-3 rounded-full bg-white/10 text-white hover:bg-white/20 transition-colors active:scale-95 touch-manipulation",children:e.jsx(G,{size:24})}),e.jsx("div",{className:"flex-1 flex gap-2",children:y.map((t,r)=>e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-500 ${r<=i?"bg-primary shadow-[0_0_10px_rgba(236,72,153,0.5)]":"bg-white/10"}`},r))})]}),e.jsxs("div",{className:"text-left md:text-center mb-8 px-2 shrink-0",children:[e.jsx(n.h2,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},className:"text-3xl md:text-2xl font-bold text-white tracking-tight",children:y[i]},y[i]),e.jsxs("p",{className:"text-gray-400 mt-1",children:["Step ",i+1," of ",y.length]})]}),e.jsx(S,{mode:"wait",children:e.jsxs(n.div,{initial:{x:20,opacity:0},animate:{x:0,opacity:1},exit:{x:-20,opacity:0},transition:{duration:.3},className:"flex-1 space-y-5 overflow-y-auto no-scrollbar pb-4",children:[i===0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(f,{placeholder:"Full Name",value:a.name,onChange:t=>l("name",t.target.value),className:"bg-black/20 border-white/10 h-14 rounded-2xl text-lg"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase ml-1",children:"Date of Birth"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{type:"date",value:a.dob,onChange:t=>l("dob",t.target.value),className:"bg-black/20 border-white/10 h-14 rounded-2xl text-lg appearance-none"}),e.jsx(X,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",size:20})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase ml-1",children:"I am a..."}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["Male","Female","Non-binary","Other"].map(t=>e.jsx("button",{className:`p-4 rounded-2xl border text-sm font-bold transition-all touch-manipulation ${a.gender===t?"bg-primary text-white border-primary shadow-lg shadow-primary/20 scale-[1.02]":"bg-black/20 border-white/10 text-gray-400 hover:bg-white/5 active:scale-95"}`,onClick:()=>l("gender",t),children:t},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase ml-1",children:"Interested in"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:["Male","Female","Everyone"].map(t=>e.jsx("button",{className:`p-4 rounded-2xl border text-sm font-bold transition-all touch-manipulation ${a.interested_in===t?"bg-primary text-white border-primary shadow-lg shadow-primary/20 scale-[1.02]":"bg-black/20 border-white/10 text-gray-400 hover:bg-white/5 active:scale-95"}`,onClick:()=>l("interested_in",t),children:t},t))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase ml-1",children:"Academic Info"}),e.jsxs("div",{className:"relative group",children:[e.jsxs("select",{className:"w-full bg-black/20 border border-white/10 rounded-2xl h-14 px-4 text-white focus:border-primary/50 outline-none appearance-none transition-all group-hover:bg-black/30",value:a.department,onChange:t=>l("department",t.target.value),children:[e.jsx("option",{value:"",children:"Select Department"}),U.map(t=>e.jsx("option",{value:t,className:"bg-gray-900",children:t},t))]}),e.jsx(v,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 rotate-90 pointer-events-none",size:16})]}),e.jsx(S,{children:a.department&&e.jsxs(n.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"relative group overflow-hidden",children:[e.jsxs("select",{className:"w-full bg-black/20 border border-white/10 rounded-2xl h-14 px-4 text-white focus:border-primary/50 outline-none appearance-none transition-all group-hover:bg-black/30",value:a.major,onChange:t=>l("major",t.target.value),children:[e.jsx("option",{value:"",children:"Select Major"}),Y[a.department]?.map(t=>e.jsx("option",{value:t,className:"bg-gray-900",children:t},t))]}),e.jsx(v,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 rotate-90 pointer-events-none",size:16})]})}),e.jsxs("div",{className:"relative group",children:[e.jsxs("select",{className:"w-full bg-black/20 border border-white/10 rounded-2xl h-14 px-4 text-white focus:border-primary/50 outline-none appearance-none transition-all group-hover:bg-black/30",value:a.year,onChange:t=>l("year",t.target.value),children:[e.jsx("option",{value:"",children:"Select Year"}),B.map(t=>e.jsx("option",{value:t,className:"bg-gray-900",children:t},t))]}),e.jsx(v,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 rotate-90 pointer-events-none",size:16})]})]})]}),i===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(f,{placeholder:"Username",value:a.username,onChange:t=>l("username",t.target.value),className:"bg-black/20 border-white/10 h-14 rounded-2xl text-lg",autoCapitalize:"none",autoCorrect:"off"}),e.jsx(f,{type:"email",placeholder:"College Email (@cet.ac.in)",value:a.email,onChange:t=>l("email",t.target.value),className:"bg-black/20 border-white/10 h-14 rounded-2xl text-lg",inputMode:"email",autoCapitalize:"none"}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"password",placeholder:"Password",className:"w-full bg-black/20 border border-white/10 rounded-2xl h-14 pl-12 pr-4 text-white focus:border-primary/50 outline-none transition-all text-lg placeholder:text-gray-500",value:a.password,onChange:t=>l("password",t.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"password",placeholder:"Confirm Password",className:"w-full bg-black/20 border border-white/10 rounded-2xl h-14 pl-12 pr-4 text-white focus:border-primary/50 outline-none transition-all text-lg placeholder:text-gray-500",value:a.confirmPassword,onChange:t=>l("confirmPassword",t.target.value)})]})]}),i===2&&e.jsxs("div",{className:"space-y-8 text-center py-4",children:[e.jsx(n.div,{initial:{scale:0},animate:{scale:1},className:"w-24 h-24 bg-primary/20 rounded-full flex items-center justify-center mx-auto text-primary mb-6",children:e.jsx(F,{size:48})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Check your Inbox"}),e.jsxs("p",{className:"text-gray-400 mt-2",children:["We sent a verification code to ",e.jsx("br",{}),e.jsx("span",{className:"text-white font-medium bg-white/10 px-2 py-1 rounded-md",children:a.email})]}),e.jsxs("button",{onClick:()=>u(1),className:"text-primary text-sm font-bold mt-4 flex items-center gap-1 mx-auto hover:text-primary/80 transition-colors",children:[e.jsx(H,{size:14})," Change Email"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"000000",autoFocus:!0,className:"w-full bg-black/20 border border-white/10 rounded-3xl py-6 text-center text-4xl tracking-[0.5em] text-white focus:border-primary/50 outline-none font-mono placeholder:text-gray-700 transition-all focus:bg-black/30",maxLength:6,inputMode:"numeric",pattern:"[0-9]*",value:b,onChange:t=>_(t.target.value.replace(/\D/g,""))}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Did not receive the code? ",e.jsx("span",{className:`text-white cursor-pointer hover:underline ${p>0?"opacity-50 cursor-not-allowed":""}`,onClick:A,children:p>0?`Resend in ${p}s`:"Resend"})]})]})]}),i===3&&e.jsx("div",{className:"space-y-6",children:Object.entries(V).map(([t,r])=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest px-1",children:t}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(s=>{const o=a.interests.includes(s);return e.jsx("button",{onClick:()=>{const x=o?a.interests.filter(g=>g!==s):[...a.interests,s];l("interests",x)},className:`px-4 py-2.5 rounded-xl text-sm font-medium border transition-all active:scale-95 touch-manipulation ${o?"bg-white text-black border-white shadow-lg scale-105":"bg-white/5 border-white/5 text-gray-400 hover:bg-white/10"}`,children:s},s)})})]},t))}),i===4&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-6",children:[e.jsx(n.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"w-72 h-72 mb-8",children:e.jsx(W,{animationData:J,loop:!0})}),e.jsxs(n.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},children:[e.jsx("h2",{className:"text-4xl font-bold text-white mb-4",children:"You're In! üéâ"}),e.jsxs("p",{className:"text-gray-300 text-lg leading-relaxed max-w-xs mx-auto",children:["Welcome to the club, ",e.jsx("span",{className:"text-primary font-bold",children:a.name.split(" ")[0]}),".",e.jsx("br",{})," Your campus love story starts now."]})]})]})]},i)}),k&&e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-red-200 text-sm font-medium text-center shrink-0",children:k}),e.jsx("div",{className:"mt-6 pt-4 border-t border-white/5 shrink-0 z-10 bg-inherit",children:e.jsx(O,{className:"w-full h-16 text-lg font-bold rounded-2xl bg-white text-black hover:bg-gray-100 transition-transform active:scale-95 disabled:opacity-50 disabled:scale-100",onClick:i===4?()=>j("/onboarding"):M,disabled:N,children:N?e.jsx(K,{className:"animate-spin"}):i===4?e.jsxs("span",{className:"flex items-center gap-2",children:["Get Started ",e.jsx(I,{size:20,fill:"currentColor"})]}):i===1?"Create Account":i===2?"Verify & Continue":"Continue"})})]}),e.jsx("div",{className:"absolute bottom-6 text-center md:hidden z-20",children:e.jsx("p",{className:"text-gray-600 text-xs uppercase tracking-widest font-bold",children:"Made with ‚ù§Ô∏è for CET"})})]})]})}export{de as default};
